var(beta_res)/var(unif_res)
unif_res <- c()
beta_res <- c()
beta_res_2 <- c()
kuma_res <- c()
for(i in 1:1000){
unif_samp <- runif(100)
unif_res[i] <- mean(sin(pi*unif_samp))
beta_samp <- rbeta(100, 2.15, 2.15)
beta_res[i] <- mean(sin(pi*beta_samp) / dbeta(beta_samp, 2.15, 2.15))
beta_samp_2 <- rbeta(100, 2, 2)
beta_res_2[i] <- mean(sin(pi*beta_samp_2) / dbeta(beta_samp_2, 2, 2))
}
var(unif_res)
var(beta_res)
var(beta_res_2)
n <- 10
nsim <- 1000
theta_hat <- rep(NA, nsim)
for(i in 1:nsim){
x <- runif(n)
theta_hat[i] <- mean(g(x))
}
g <- function(x){exp(-x)/(1 + x^2)}
n <- 10
nsim <- 1000
theta_hat <- rep(NA, nsim)
for(i in 1:nsim){
x <- runif(n)
theta_hat[i] <- mean(g(x))
}
var(theta_hat)
sd(theta_hat)
var(thea_hat2)
var(theta_hat2)
g2 <- function(x){ pi/4 * exp(-x)}
n <- 10; nsim <- 1000
theta_hat2 <- rep(NA, nsim)
for(i in 1:nsim){
x <- tan(runif(n) * pi/4)
theta_hat2[i] <- mean(g2(x))
}
var(theta_hat2)
sd(theta_hat2)
theta_hat2 <- rep(NA, nsim)
for(i in 1:nsim){
x <- tan(runif(n) * pi/4)
theta_hat2[i] <- mean(g2(x))
}
var(theta_hat2)
theta_hat2 <- rep(NA, nsim)
for(i in 1:nsim){
x <- tan(runif(n) * pi/4)
theta_hat2[i] <- mean(g2(x))
}
var(theta_hat2)
theta_hat2 <- rep(NA, nsim)
for(i in 1:nsim){
x <- tan(runif(n) * pi/4)
theta_hat2[i] <- mean(g2(x))
}
var(theta_hat2)
theta_hat2 <- rep(NA, nsim)
for(i in 1:nsim){
x <- tan(runif(n) * pi/4)
theta_hat2[i] <- mean(g2(x))
}
var(theta_hat2)
theta_hat2 <- rep(NA, nsim)
for(i in 1:nsim){
x <- tan(runif(n) * pi/4)
theta_hat2[i] <- mean(g2(x))
}
var(theta_hat2)
theta_hat2 <- rep(NA, nsim)
for(i in 1:nsim){
x <- tan(runif(n) * pi/4)
theta_hat2[i] <- mean(g2(x))
}
var(theta_hat2)
theta_hat2 <- rep(NA, nsim)
for(i in 1:nsim){
x <- tan(runif(n) * pi/4)
theta_hat2[i] <- mean(g2(x))
}
var(theta_hat2)
theta_hat2 <- rep(NA, nsim)
for(i in 1:nsim){
x <- tan(runif(n) * pi/4)
theta_hat2[i] <- mean(g2(x))
}
var(theta_hat2)
theta_hat2 <- rep(NA, nsim)
for(i in 1:nsim){
x <- tan(runif(n) * pi/4)
theta_hat2[i] <- mean(g2(x))
}
var(theta_hat2)
nsim <- 10000
theta_hat <- rep(NA, nsim)
for(i in 1:nsim){
x <- runif(n)
theta_hat[i] <- mean(g(x))
}
var(theta_hat)
theta_hat <- rep(NA, nsim)
for(i in 1:nsim){
x <- runif(n)
theta_hat[i] <- mean(g(x))
}
var(theta_hat)
theta_hat <- rep(NA, nsim)
for(i in 1:nsim){
x <- runif(n)
theta_hat[i] <- mean(g(x))
}
var(theta_hat)
theta_hat <- rep(NA, nsim)
for(i in 1:nsim){
x <- runif(n)
theta_hat[i] <- mean(g(x))
}
var(theta_hat)
theta_hat <- rep(NA, nsim)
for(i in 1:nsim){
x <- runif(n)
theta_hat[i] <- mean(g(x))
}
var(theta_hat)
theta_hat <- rep(NA, nsim)
for(i in 1:nsim){
x <- runif(n)
theta_hat[i] <- mean(g(x))
}
var(theta_hat)
theta_hat <- rep(NA, nsim)
for(i in 1:nsim){
x <- runif(n)
theta_hat[i] <- mean(g(x))
}
var(theta_hat)
theta_hat <- rep(NA, nsim)
for(i in 1:nsim){
x <- runif(n)
theta_hat[i] <- mean(g(x))
}
var(theta_hat)
theta_hat2 <- rep(NA, nsim)
for(i in 1:nsim){
x <- tan(runif(n) * pi/4)
theta_hat2[i] <- mean(g2(x))
}
var(theta_hat2)
theta_hat2 <- rep(NA, nsim)
for(i in 1:nsim){
x <- tan(runif(n) * pi/4)
theta_hat2[i] <- mean(g2(x))
}
var(theta_hat2)
theta_hat2 <- rep(NA, nsim)
for(i in 1:nsim){
x <- tan(runif(n) * pi/4)
theta_hat2[i] <- mean(g2(x))
}
var(theta_hat2)
theta_hat2 <- rep(NA, nsim)
for(i in 1:nsim){
x <- tan(runif(n) * pi/4)
theta_hat2[i] <- mean(g2(x))
}
var(theta_hat2)
theta_hat2 <- rep(NA, nsim)
for(i in 1:nsim){
x <- tan(runif(n) * pi/4)
theta_hat2[i] <- mean(g2(x))
}
var(theta_hat2)
theta_hat2 <- rep(NA, nsim)
for(i in 1:nsim){
x <- tan(runif(n) * pi/4)
theta_hat2[i] <- mean(g2(x))
}
var(theta_hat2)
theta_hat2 <- rep(NA, nsim)
for(i in 1:nsim){
x <- tan(runif(n) * pi/4)
theta_hat2[i] <- mean(g2(x))
}
var(theta_hat2)
theta_hat2 <- rep(NA, nsim)
for(i in 1:nsim){
x <- tan(runif(n) * pi/4)
theta_hat2[i] <- mean(g2(x))
}
var(theta_hat2)
theta_hat2 <- rep(NA, nsim)
for(i in 1:nsim){
x <- tan(runif(n) * pi/4)
theta_hat2[i] <- mean(g2(x))
}
var(theta_hat2)
var(theta_hat)
(var(theta_hat) - var(\theta_hat2))/var(theta_hat)
(var(theta_hat) - var(theta_hat2))/var(theta_hat)
h <- function(x){
exp(-x)/(1 + x^2)
}
f1 <- function(x){
rep(1, length(x))
}
f2 <- function(x){
4/pi * (1 + x^2)^{-1}
}
gridpts <- seq(0, 1, 0.01)
data.frame(x = rep(gridpts, 3),
y = c(h(gridpts), f1(gridpts), f2(gridpts)),
type = rep(c("h(x)", "f1(x)", "f2(x)"))) |>
ggplot(aes(x = x, y = y, color=type)) +
geom_line()
data.frame(x = rep(gridpts, 3),
y = c(h(gridpts), f1(gridpts), f2(gridpts)),
type = rep(c("h(x)", "f1(x)", "f2(x)"), each=length(gridpts))) |>
ggplot(aes(x = x, y = y, color=type)) +
geom_line()
n <- 100
nsim <- 10000
theta_hat <- rep(NA,nsim)
for(i in 1:nsim){
x <- runif(n)
theta_hat[i] <- mean(sin(pi*x))
}
mean(theta_hat)
pi/2
2/pi
n <- 100
nsim <- 10000
theta_hat <- rep(NA,nsim)
for(i in 1:nsim){
x <- runif(n)
theta_hat[i] <- mean(sin(pi*x))
}
var(theta_hat)
gridpts <- seq(0, 1, 0.01)
plot(gridpts, sin(pi*gridpts), type="l")
lines(gridpts, dbeta(gridpts, 2, 2), col="blue")
gridpts <- seq(0, 1, 0.01)
plot(gridpts, sin(pi*gridpts), type="l", ylim=c(0, 1.5))
lines(gridpts, dbeta(gridpts, 2, 2), col="blue")
gridpts <- seq(0, 1, 0.01)
plot(gridpts, sin(pi*gridpts), type="l", ylim=c(0, 1.5), xlab="x", ylab="")
lines(gridpts, dbeta(gridpts, 2, 2), col="blue")
n <- 100
nsim <- 10000
theta_hat2 <- rep(NA,nsim)
for(i in 1:nsim){
x <- rbeta(n, 2, 2)
theta_hat2[i] <- mean(sin(pi*x)/dbeta(x, 2, 2))
}
mean(theta_hat2)
n <- 100
nsim <- 10000
theta_hat2 <- rep(NA,nsim)
for(i in 1:nsim){
x <- rbeta(n, 2, 2)
theta_hat2[i] <- mean(sin(pi*x)/dbeta(x, 2, 2))
}
var(theta_hat2)
var(theta_hat2)/var(theta_hat1)
plot(gridpts, pi/2 * sin(pi*gridpts), type="l", xlab="x", ylab="")
lines(gridpts, dbeta(gridpts, 2.2, 2.2), col="blue")
plot(gridpts, pi/2 * sin(pi*gridpts), type="l", xlab="x", ylab="")
lines(gridpts, dbeta(gridpts, 2.15, 2.15), col="blue")
n <- 100
nsim <- 10000
theta_hat3 <- rep(NA,nsim)
for(i in 1:nsim){
x <- rbeta(n, 2.15, 2.15)
theta_hat3[i] <- mean(sin(pi*x)/dbeta(x, 2.15, 2.15))
}
var(theta_hat3)
var(theta_hat3)/var(theta_hat2)
l8 <- function(x){
x^8 - 64*x^7 + 1568*x^6 - 18816*x^5 + 117600*x^4 - 376320*x^3 + 564480*x^2 - 322560*x + 40320
}
l9 <- function(x){
x^9 - 81*x^8 + 2592*x^7 - 42336*x^6 + 381024*x^5 - 1905120*x^4 +
5080320*x^3 - 6531840*x^2 + 3265920*x - 362880
}
nodes <- uniroot.all(l8, c(0, 30), tol=1e-12)
nodes
weights <- nodes/(81* l9(nodes)^2) * (362880)^2
weights
sum(weights)
w <- c(3.691886e-01, 4.187868e-01, 1.757950e-01, 3.334349e-02,
2.794536e-03, 9.076509e-05, 8.485747e-07, 1.048001e-09)
x <- c(0.1702796, 0.9037018, 2.2510866, 4.2667002, 7.0459054,
10.7585160, 15.7406786, 22.8631317)
x
nodes
x - nodes
w
w - WeightLoss
w - weights
sum(w)
birds <- read.csv("https://raw.githubusercontent.com/proback/BeyondMLR/master/data/birdkeeping.csv")
View(birds)
birds <- read_csv("https://raw.githubusercontent.com/proback/BeyondMLR/master/data/birdkeeping.csv")
?read.csv
nsim <- 1000
h <- function(x){
x/(2^x - 1)
}
n <- 500
theta_hat1 <- rep(NA, n)
theta_hat2 <- rep(NA, n)
theta_hat <- rep(NA, n)
for(i in 1:nsim){
x <- rnorm(1000)
theta_hat <- mean(h(x))
theta_hat1 <- mean(h(x[1:n]))
theta_hat2 <- mean(h(x[(n+1):(2*n)]))
}
mean(theta_hat)
mean(0.5*(theta_hat1 + theta_hat2))
nsim <- 1000
h <- function(x){
x/(2^x - 1)
}
n <- 500
theta_hat1 <- rep(NA, n)
theta_hat2 <- rep(NA, n)
theta_hat <- rep(NA, n)
for(i in 1:nsim){
x <- rnorm(1000)
theta_hat <- mean(h(x))
theta_hat1 <- mean(h(x[1:n]))
theta_hat2 <- mean(h(-1*x[(n+1):(2*n)]))
}
mean(theta_hat)
mean(0.5*(theta_hat1 + theta_hat2))
var(theta_hat)
theta_hat
nsim <- 1000
h <- function(x){
x/(2^x - 1)
}
n <- 500
theta_hat1 <- rep(NA, n)
theta_hat2 <- rep(NA, n)
theta_hat <- rep(NA, n)
for(i in 1:nsim){
x <- rnorm(1000)
theta_hat[i] <- mean(h(x))
theta_hat1[i] <- mean(h(x[1:n]))
theta_hat2[i] <- mean(h(-1*x[(n+1):(2*n)]))
}
mean(theta_hat)
mean(0.5*(theta_hat1 + theta_hat2))
var(theta_hat)
var(0.5*(theta_hat1 + theta_hat2))
nsim <- 1000
h <- function(x){
x/(2^x - 1)
}
n <- 500
theta_hat1 <- rep(NA, nsim)
theta_hat2 <- rep(NA, nsim)
for(i in 1:nsim){
x <- rnorm(1000)
theta_hat1[i] <- mean(h(x))
theta_hat1[i] <- sum(h(x[1:n]) + h(-1*x[1:n]))/(2*n)
}
mean(theta_hat)
mean(theta_hat1)
mean(theta_hat2)
theta_hat2
sum(h(x[1:n]) + h(-1*x[1:n]))/(2*n)
nsim <- 1000
h <- function(x){
x/(2^x - 1)
}
n <- 500
theta_hat1 <- rep(NA, nsim)
theta_hat2 <- rep(NA, nsim)
for(i in 1:nsim){
x <- rnorm(1000)
theta_hat1[i] <- mean(h(x))
theta_hat2[i] <- sum(h(x[1:n]) + h(-1*x[1:n]))/(2*n)
}
mean(theta_hat1)
mean(theta_hat2)
var(theta_hat1)
var(theta_hat2)
(var(theta_hat1) - var(theta_hat2))/var(theta_hat1)
nsim <- 1000
h <- function(x){
x/(2^x - 1)
}
n <- 500
theta_hat <- rep(NA, nsim)
theta_hat1 <- rep(NA, nsim)
theta_hat2 <- rep(NA, nsim)
for(i in 1:nsim){
x <- rnorm(1000)
theta_hat[i] <- mean(h(x))
theta_hat1[i] <- mean(h(x[1:n]))
theta_hat2[i] <- mean(h(-1*x[1:n]))
}
mean(theta_hat1)
mean(theta_hat2)
var(theta_hat1)
var(theta_hat2)
var(theta_hat)
var(0.5*(theta_hat1 + theta_hat2))
mean(0.5*(theta_hat1 + theta_hat2))
cor(g(x[1:n]))
cor(g(x[1:n]), g(-x[1:n]))
x <- rnorm(100000)
cor(g(x), g(-x))
cor(h(x), h(-x))
g <- function(x){
log(x + 1)*exp(x)
}
n <- 1000
nsim <- 1000
theta_hat_mc <- rep(NA, nsim)
for(i in 1:nsim){
u <- runif(n)
theta_hat_mc[i] <- mean(g(u))
}
var(theta_hat_mc)
theta_hat_as <- rep(NA, nsim)
for(i in 1:nsim){
u <- runif(n/2)
theta_hat_as[i] <- sum(g(u) + g(1-u))/n
}
var(theta_hat_as)
(var(theta_hat_mc) - var(theta_hat_as))/var(theta_hat_mc)
u <- runif(10000)
cor(g(u), g(1-u))
l8 <- function(x) {
x^8 - 64*x^7 + 1568*x^6 - 18816*x^5 + 177600*x^4 - 376320*x^3 + 564480*x^2 - 322560*x + 40320
}
uniroot.all(l8, c(0, 30), tol=1e-12)
l8 <- function(x) {
x^8 - 64*x^7 + 1568*x^6 - 18816*x^5 + 117600*x^4 - 376320*x^3 + 564480*x^2 - 322560*x + 40320
}
uniroot.all(l8, c(0, 30), tol=1e-12)
l8 <- function(x) {
x^8 - 64*x^7 + 1568*x^6 - 18816*x^5 + 117600*x^4 - 376320*x^3 + 564480*x^2 - 322560*x + 40320
#x^8 - 64*x^7 + 1568*x^6 - 18816*x^5 + 117600*x^4 - 376320*x^3 + 564480*x^2 - 322560*x + 40320
}
uniroot.all(l8, c(0, 30), tol=1e-12)
l8 <- function(x){
x^8 - 64*x^7 + 1568*x^6 - 18816*x^5 + 117600*x^4 - 376320*x^3 + 564480*x^2 - 322560*x + 40320
}
nodes <- uniroot.all(l8, c(0, 30), tol=1e-12)
noes
nodes
u <- runif(10000)
cor(exp(u), exp(1-u))
theta_hat_as <- rep(NA, nsim)
for(i in 1:nsim){
u <- runif(n/2)
theta_hat_as[i] <- sum(g(u) + g(1-u))/n
}
var(theta_hat_as)
(var(theta_hat_mc) - var(theta_hat_as))/var(theta_hat_mc)
theta_hat_as <- rep(NA, nsim)
for(i in 1:nsim){
u <- runif(n/2)
theta_hat_as[i] <- sum(g(u) + g(1-u))/n
}
var(theta_hat_as)
(var(theta_hat_mc) - var(theta_hat_as))/var(theta_hat_mc)
u <- runif(10000)
cor(g(u), g(1-u))
theta_hat_as <- rep(NA, nsim)
for(i in 1:nsim){
u <- runif(n/2)
theta_hat_as[i] <- sum(g(u) + g(1-u))/n
}
var(theta_hat_as)
(var(theta_hat_mc) - var(theta_hat_as))/var(theta_hat_mc)
u <- runif(10000)
cor(g(u), g(1-u))
?Finv
g <- function(x){
exp(-x)
}
Finv <- function(u){
(1 - u)^{-1/4}
}
n <- 200
nsim <- 10000
theta_hat_as <- rep(NA, nsim)
for(i in 1:nsim){
u <- runif(n/2)
theta_hat_as[i] <- sum(g(Finv(u)) + g(Finv(1-u)))/n
}
var(theta_hat_as)
mean(theta_hat_as)
theta_hat_mc <- rep(NA, nsim)
for(i in 1:nsim){
u <- runif(n)
x <- Finv(u)
theta_hat_mc[i] <- mean(g(x))
}
var(theta_hat_mc)
(var(theta_hat_mc) - var(theta_hat_as))/var(theta_hat_mc)
u <- runif(10000)
cor(g(Finv(u)), g(Finv(1-u)))
